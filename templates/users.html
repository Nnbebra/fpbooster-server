{% extends "base.html" %}
{% block content %}
<h2 class="mb-4">Пользователи</h2>

<!-- Панель поиска -->
<div class="d-flex justify-content-between align-items-center mb-4">
  <form method="get" action="/admin/users" class="d-flex w-50">
    <input type="text" class="form-control me-2" name="q" placeholder="Поиск по email/логину/UID" value="{{ q }}">
    <button type="submit" class="btn btn-purple">Искать</button>
  </form>
</div>

<!-- Таблица пользователей -->
<div class="card-dark">
  <table class="table table-dark table-striped table-hover rounded overflow-hidden mb-0">
    <thead>
      <tr>
        <th>Email</th>
        <th>Логин</th>
        <th>UID</th>
        <th>Группа</th>
        <th>Дата регистрации</th>
        <th>Последний вход</th>
        <th>Действия</th>
      </tr>
    </thead>
    <tbody>
      {% for row in rows %}
      <tr>
        <td>{{ row.email }}</td>
        <td>{{ row.username or "—" }}</td>
        <td><code>{{ row.uid }}</code></td>
        <td><span class="badge bg-gradient-purple">{{ row.user_group }}</span></td>
        <td>{{ row.created_at.strftime("%Y-%m-%d %H:%M:%S") if row.created_at else "—" }}</td>
        <td>{{ row.last_login.strftime("%Y-%m-%d %H:%M:%S") if row.last_login else "—" }}</td>
        <td>
          <a href="/admin/users/edit/{{ row.uid }}" class="btn btn-sm btn-purple">
            <i class="fas fa-edit"></i> Изменить
          </a>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
