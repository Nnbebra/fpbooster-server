{% extends "base.html" %}
{% block content %}
<h2 class="mb-4">
  {% if row %}
    Редактировать лицензию
  {% else %}
    Создать лицензию
  {% endif %}
</h2>

<div class="card-dark w-75 mx-auto">
  <form method="post"
        {% if row %}
          action="/admin/licenses/edit/{{ row.license_key }}"
        {% else %}
          action="/admin/licenses/new"
        {% endif %}>

    <div class="mb-3">
      <label for="license_key" class="form-label">Ключ</label>
      <input type="text" class="form-control" id="license_key" name="license_key"
             value="{{ row.license_key if row else '' }}" {% if row %}readonly{% endif %} required>
    </div>

    <div class="mb-3">
      <label for="status" class="form-label">Статус</label>
      <select class="form-select" id="status" name="status" required>
        <option value="active" {% if row and row.status == "active" %}selected{% endif %}>Активна</option>
        <option value="expired" {% if row and row.status == "expired" %}selected{% endif %}>Истекла</option>
        <option value="banned" {% if row and row.status == "banned" %}selected{% endif %}>Заблокирована</option>
      </select>
    </div>

    <div class="mb-3">
      <label for="expires" class="form-label">Дата окончания</label>
      <input type="date" class="form-control" id="expires" name="expires"
             value="{{ row.expires if row and row.expires else '' }}">
    </div>

    <div class="mb-3">
      <label for="user" class="form-label">Пользователь</label>
      <input type="text" class="form-control" id="user" name="user"
             value="{{ row.user_name if row else '' }}">
    </div>

    {% if error %}
      <div class="alert alert-danger">{{ error }}</div>
    {% endif %}

    <div class="d-flex justify-content-between mt-4">
      <a href="/admin/licenses" class="btn btn-secondary-custom">
        <i class="fas fa-arrow-left"></i> Отмена
      </a>
      <button type="submit" class="btn btn-purple">
        {% if row %}
          <i class="fas fa-save"></i> Сохранить изменения
        {% else %}
          <i class="fas fa-plus"></i> Создать лицензию
        {% endif %}
      </button>
    </div>
  </form>
</div>
{% endblock %}
